{"version":3,"file":"index.cjs.js","sources":["../../src/index.js"],"sourcesContent":["const BTICK_CODE = 96; // `\nconst CCURLY_CODE = 125; // }\nconst TAGGED_TEMPLATE_EXPRESSION = 'TaggedTemplateExpression';\nconst TEMPLATE_LITERAL = 'TemplateLiteral';\nconst TEMPLATE_ELEMENT = 'TemplateElement';\n\nexport default {\n\tname: 'jsepTemplateLiteral',\n\n\tinit(jsep) {\n\t\tfunction gobbleTemplateLiteral(env, gobbleMember = true) {\n\t\t\tif (this.code === BTICK_CODE) {\n\t\t\t\tconst node = {\n\t\t\t\t\ttype: TEMPLATE_LITERAL,\n\t\t\t\t\tquasis: [],\n\t\t\t\t\texpressions: [],\n\t\t\t\t};\n\t\t\t\tlet cooked = '';\n\t\t\t\tlet raw = '';\n\t\t\t\tlet closed = false;\n\t\t\t\tconst length = this.expr.length;\n\t\t\t\tconst pushQuasi = () => node.quasis.push({\n\t\t\t\t\ttype: TEMPLATE_ELEMENT,\n\t\t\t\t\tvalue: {\n\t\t\t\t\t\traw,\n\t\t\t\t\t\tcooked,\n\t\t\t\t\t},\n\t\t\t\t\ttail: closed,\n\t\t\t\t});\n\n\t\t\t\twhile (this.index < length) {\n\t\t\t\t\tlet ch = this.expr.charAt(++this.index);\n\n\t\t\t\t\tif (ch === '`') {\n\t\t\t\t\t\tthis.index += 1;\n\t\t\t\t\t\tclosed = true;\n\t\t\t\t\t\tpushQuasi();\n\n\t\t\t\t\t\tenv.node = node;\n\n\t\t\t\t\t\tif (gobbleMember) {\n\t\t\t\t\t\t  // allow . [] and () after template: `foo`.length\n\t\t\t\t\t\t  env.node = this.gobbleTokenProperty(env.node);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn env.node;\n\t\t\t\t\t}\n\t\t\t\t\telse if (ch === '$' && this.expr.charAt(this.index + 1) === '{') {\n\t\t\t\t\t\tthis.index += 2;\n\t\t\t\t\t\tpushQuasi();\n\t\t\t\t\t\traw = '';\n\t\t\t\t\t\tcooked = '';\n\t\t\t\t\t\tnode.expressions.push(...this.gobbleExpressions(CCURLY_CODE));\n\t\t\t\t\t\tif (this.code !== CCURLY_CODE) {\n\t\t\t\t\t\t\tthis.throwError('unclosed ${');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse if (ch === '\\\\') {\n\t\t\t\t\t\t// Check for all of the common escape codes\n\t\t\t\t\t\traw += ch;\n\t\t\t\t\t\tch = this.expr.charAt(++this.index);\n\t\t\t\t\t\traw += ch;\n\n\t\t\t\t\t\tswitch (ch) {\n\t\t\t\t\t\t\tcase 'n': cooked += '\\n'; break;\n\t\t\t\t\t\t\tcase 'r': cooked += '\\r'; break;\n\t\t\t\t\t\t\tcase 't': cooked += '\\t'; break;\n\t\t\t\t\t\t\tcase 'b': cooked += '\\b'; break;\n\t\t\t\t\t\t\tcase 'f': cooked += '\\f'; break;\n\t\t\t\t\t\t\tcase 'v': cooked += '\\x0B'; break;\n\t\t\t\t\t\t\tdefault : cooked += ch;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tcooked += ch;\n\t\t\t\t\t\traw += ch;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.throwError('Unclosed `');\n\t\t\t}\n\t\t}\n\n\t\tjsep.hooks.add('gobble-token', gobbleTemplateLiteral);\n\n\t\tjsep.hooks.add('after-token', function gobbleTaggedTemplateIdentifier(env) {\n\t\t\tif ((env.node.type === jsep.IDENTIFIER || env.node.type === jsep.MEMBER_EXP) && this.code === BTICK_CODE) {\n\t\t\t\tenv.node = {\n\t\t\t\t\ttype: TAGGED_TEMPLATE_EXPRESSION,\n\t\t\t\t\ttag: env.node,\n\t\t\t\t\tquasi: gobbleTemplateLiteral.bind(this)(env, false),\n\t\t\t\t};\n\n\t\t\t\t// allow . [] and () after tagged template: bar`foo`.length\n\t\t\t\tenv.node = this.gobbleTokenProperty(env.node);\n\n\t\t\t\treturn env.node;\n\t\t\t}\n\t\t});\n\t}\n};\n"],"names":[],"mappings":"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"}