{"version":3,"file":"index.cjs.min.js","sources":["../../src/index.js"],"sourcesContent":["const BTICK_CODE = 96; // `\nconst CCURLY_CODE = 125; // }\nconst TAGGED_TEMPLATE_EXPRESSION = 'TaggedTemplateExpression';\nconst TEMPLATE_LITERAL = 'TemplateLiteral';\nconst TEMPLATE_ELEMENT = 'TemplateElement';\n\nexport default {\n\tname: 'jsepTemplateLiteral',\n\n\tinit(jsep) {\n\t\tfunction gobbleTemplateLiteral(env, gobbleMember = true) {\n\t\t\tif (this.code === BTICK_CODE) {\n\t\t\t\tconst node = {\n\t\t\t\t\ttype: TEMPLATE_LITERAL,\n\t\t\t\t\tquasis: [],\n\t\t\t\t\texpressions: [],\n\t\t\t\t};\n\t\t\t\tlet cooked = '';\n\t\t\t\tlet raw = '';\n\t\t\t\tlet closed = false;\n\t\t\t\tconst length = this.expr.length;\n\t\t\t\tconst pushQuasi = () => node.quasis.push({\n\t\t\t\t\ttype: TEMPLATE_ELEMENT,\n\t\t\t\t\tvalue: {\n\t\t\t\t\t\traw,\n\t\t\t\t\t\tcooked,\n\t\t\t\t\t},\n\t\t\t\t\ttail: closed,\n\t\t\t\t});\n\n\t\t\t\twhile (this.index < length) {\n\t\t\t\t\tlet ch = this.expr.charAt(++this.index);\n\n\t\t\t\t\tif (ch === '`') {\n\t\t\t\t\t\tthis.index += 1;\n\t\t\t\t\t\tclosed = true;\n\t\t\t\t\t\tpushQuasi();\n\n\t\t\t\t\t\tenv.node = node;\n\n\t\t\t\t\t\tif (gobbleMember) {\n\t\t\t\t\t\t  // allow . [] and () after template: `foo`.length\n\t\t\t\t\t\t  env.node = this.gobbleTokenProperty(env.node);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn env.node;\n\t\t\t\t\t}\n\t\t\t\t\telse if (ch === '$' && this.expr.charAt(this.index + 1) === '{') {\n\t\t\t\t\t\tthis.index += 2;\n\t\t\t\t\t\tpushQuasi();\n\t\t\t\t\t\traw = '';\n\t\t\t\t\t\tcooked = '';\n\t\t\t\t\t\tnode.expressions.push(...this.gobbleExpressions(CCURLY_CODE));\n\t\t\t\t\t\tif (this.code !== CCURLY_CODE) {\n\t\t\t\t\t\t\tthis.throwError('unclosed ${');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse if (ch === '\\\\') {\n\t\t\t\t\t\t// Check for all of the common escape codes\n\t\t\t\t\t\traw += ch;\n\t\t\t\t\t\tch = this.expr.charAt(++this.index);\n\t\t\t\t\t\traw += ch;\n\n\t\t\t\t\t\tswitch (ch) {\n\t\t\t\t\t\t\tcase 'n': cooked += '\\n'; break;\n\t\t\t\t\t\t\tcase 'r': cooked += '\\r'; break;\n\t\t\t\t\t\t\tcase 't': cooked += '\\t'; break;\n\t\t\t\t\t\t\tcase 'b': cooked += '\\b'; break;\n\t\t\t\t\t\t\tcase 'f': cooked += '\\f'; break;\n\t\t\t\t\t\t\tcase 'v': cooked += '\\x0B'; break;\n\t\t\t\t\t\t\tdefault : cooked += ch;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tcooked += ch;\n\t\t\t\t\t\traw += ch;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.throwError('Unclosed `');\n\t\t\t}\n\t\t}\n\n\t\tjsep.hooks.add('gobble-token', gobbleTemplateLiteral);\n\n\t\tjsep.hooks.add('after-token', function gobbleTaggedTemplateIdentifier(env) {\n\t\t\tif ((env.node.type === jsep.IDENTIFIER || env.node.type === jsep.MEMBER_EXP) && this.code === BTICK_CODE) {\n\t\t\t\tenv.node = {\n\t\t\t\t\ttype: TAGGED_TEMPLATE_EXPRESSION,\n\t\t\t\t\ttag: env.node,\n\t\t\t\t\tquasi: gobbleTemplateLiteral.bind(this)(env, false),\n\t\t\t\t};\n\n\t\t\t\t// allow . [] and () after tagged template: bar`foo`.length\n\t\t\t\tenv.node = this.gobbleTokenProperty(env.node);\n\n\t\t\t\treturn env.node;\n\t\t\t}\n\t\t});\n\t}\n};\n"],"names":["name","init","jsep","gobbleTemplateLiteral","env","gobbleMember","this","code","node","type","quasis","expressions","cooked","raw","closed","length","expr","pushQuasi","push","value","tail","index","ch","charAt","gobbleTokenProperty","gobbleExpressions","throwError","hooks","add","IDENTIFIER","MEMBER_EXP","tag","quasi","bind"],"mappings":"aAMA,MAAe,CACdA,KAAM,sBAENC,KAAKC,GACJ,SAASC,EAAsBC,EAAKC,GAAe,GAClD,GAXgB,KAWZC,KAAKC,KAAqB,CAC7B,MAAMC,EAAO,CACZC,KAVoB,kBAWpBC,OAAQ,GACRC,YAAa,IAEd,IAAIC,EAAS,GACTC,EAAM,GACNC,GAAS,EACb,MAAMC,EAAST,KAAKU,KAAKD,OACnBE,EAAY,IAAMT,EAAKE,OAAOQ,KAAK,CACxCT,KAlBoB,kBAmBpBU,MAAO,CACNN,IAAAA,EACAD,OAAAA,GAEDQ,KAAMN,IAGP,KAAOR,KAAKe,MAAQN,GAAQ,CAC3B,IAAIO,EAAKhB,KAAKU,KAAKO,SAASjB,KAAKe,OAEjC,GAAW,MAAPC,EAYH,OAXAhB,KAAKe,OAAS,EACdP,GAAS,EACTG,IAEAb,EAAII,KAAOA,EAEPH,IAEFD,EAAII,KAAOF,KAAKkB,oBAAoBpB,EAAII,OAGnCJ,EAAII,KAEP,GAAW,MAAPc,GAAmD,MAArChB,KAAKU,KAAKO,OAAOjB,KAAKe,MAAQ,GACpDf,KAAKe,OAAS,EACdJ,IACAJ,EAAM,GACND,EAAS,GACTJ,EAAKG,YAAYO,QAAQZ,KAAKmB,kBAnDhB,MAAA,MAoDVnB,KAAKC,MACRD,KAAKoB,WAAW,oBAGb,GAAW,OAAPJ,EAMR,OAJAT,GAAOS,EACPA,EAAKhB,KAAKU,KAAKO,SAASjB,KAAKe,OAC7BR,GAAOS,EAECA,GACP,IAAK,IAAKV,GAAU,KAAM,MAC1B,IAAK,IAAKA,GAAU,KAAM,MAC1B,IAAK,IAAKA,GAAU,KAAM,MAC1B,IAAK,IAAKA,GAAU,KAAM,MAC1B,IAAK,IAAKA,GAAU,KAAM,MAC1B,IAAK,IAAKA,GAAU,KAAQ,MAC5B,QAAUA,GAAUU,OAIrBV,GAAUU,EACVT,GAAOS,EAGThB,KAAKoB,WAAW,eAIlBxB,EAAKyB,MAAMC,IAAI,eAAgBzB,GAE/BD,EAAKyB,MAAMC,IAAI,eAAe,SAAwCxB,GACrE,IAAKA,EAAII,KAAKC,OAASP,EAAK2B,YAAczB,EAAII,KAAKC,OAASP,EAAK4B,aArFjD,KAqFgExB,KAAKC,KAUpF,OATAH,EAAII,KAAO,CACVC,KArF8B,2BAsF9BsB,IAAK3B,EAAII,KACTwB,MAAO7B,EAAsB8B,KAAK3B,KAA3BH,CAAiCC,GAAK,IAI9CA,EAAII,KAAOF,KAAKkB,oBAAoBpB,EAAII,MAEjCJ,EAAII"}