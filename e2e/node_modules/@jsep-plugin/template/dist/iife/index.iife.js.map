{"version":3,"file":"index.iife.js","sources":["../../src/index.js"],"sourcesContent":["const BTICK_CODE = 96; // `\nconst CCURLY_CODE = 125; // }\nconst TAGGED_TEMPLATE_EXPRESSION = 'TaggedTemplateExpression';\nconst TEMPLATE_LITERAL = 'TemplateLiteral';\nconst TEMPLATE_ELEMENT = 'TemplateElement';\n\nexport default {\n\tname: 'jsepTemplateLiteral',\n\n\tinit(jsep) {\n\t\tfunction gobbleTemplateLiteral(env, gobbleMember = true) {\n\t\t\tif (this.code === BTICK_CODE) {\n\t\t\t\tconst node = {\n\t\t\t\t\ttype: TEMPLATE_LITERAL,\n\t\t\t\t\tquasis: [],\n\t\t\t\t\texpressions: [],\n\t\t\t\t};\n\t\t\t\tlet cooked = '';\n\t\t\t\tlet raw = '';\n\t\t\t\tlet closed = false;\n\t\t\t\tconst length = this.expr.length;\n\t\t\t\tconst pushQuasi = () => node.quasis.push({\n\t\t\t\t\ttype: TEMPLATE_ELEMENT,\n\t\t\t\t\tvalue: {\n\t\t\t\t\t\traw,\n\t\t\t\t\t\tcooked,\n\t\t\t\t\t},\n\t\t\t\t\ttail: closed,\n\t\t\t\t});\n\n\t\t\t\twhile (this.index < length) {\n\t\t\t\t\tlet ch = this.expr.charAt(++this.index);\n\n\t\t\t\t\tif (ch === '`') {\n\t\t\t\t\t\tthis.index += 1;\n\t\t\t\t\t\tclosed = true;\n\t\t\t\t\t\tpushQuasi();\n\n\t\t\t\t\t\tenv.node = node;\n\n\t\t\t\t\t\tif (gobbleMember) {\n\t\t\t\t\t\t  // allow . [] and () after template: `foo`.length\n\t\t\t\t\t\t  env.node = this.gobbleTokenProperty(env.node);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn env.node;\n\t\t\t\t\t}\n\t\t\t\t\telse if (ch === '$' && this.expr.charAt(this.index + 1) === '{') {\n\t\t\t\t\t\tthis.index += 2;\n\t\t\t\t\t\tpushQuasi();\n\t\t\t\t\t\traw = '';\n\t\t\t\t\t\tcooked = '';\n\t\t\t\t\t\tnode.expressions.push(...this.gobbleExpressions(CCURLY_CODE));\n\t\t\t\t\t\tif (this.code !== CCURLY_CODE) {\n\t\t\t\t\t\t\tthis.throwError('unclosed ${');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse if (ch === '\\\\') {\n\t\t\t\t\t\t// Check for all of the common escape codes\n\t\t\t\t\t\traw += ch;\n\t\t\t\t\t\tch = this.expr.charAt(++this.index);\n\t\t\t\t\t\traw += ch;\n\n\t\t\t\t\t\tswitch (ch) {\n\t\t\t\t\t\t\tcase 'n': cooked += '\\n'; break;\n\t\t\t\t\t\t\tcase 'r': cooked += '\\r'; break;\n\t\t\t\t\t\t\tcase 't': cooked += '\\t'; break;\n\t\t\t\t\t\t\tcase 'b': cooked += '\\b'; break;\n\t\t\t\t\t\t\tcase 'f': cooked += '\\f'; break;\n\t\t\t\t\t\t\tcase 'v': cooked += '\\x0B'; break;\n\t\t\t\t\t\t\tdefault : cooked += ch;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tcooked += ch;\n\t\t\t\t\t\traw += ch;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.throwError('Unclosed `');\n\t\t\t}\n\t\t}\n\n\t\tjsep.hooks.add('gobble-token', gobbleTemplateLiteral);\n\n\t\tjsep.hooks.add('after-token', function gobbleTaggedTemplateIdentifier(env) {\n\t\t\tif ((env.node.type === jsep.IDENTIFIER || env.node.type === jsep.MEMBER_EXP) && this.code === BTICK_CODE) {\n\t\t\t\tenv.node = {\n\t\t\t\t\ttype: TAGGED_TEMPLATE_EXPRESSION,\n\t\t\t\t\ttag: env.node,\n\t\t\t\t\tquasi: gobbleTemplateLiteral.bind(this)(env, false),\n\t\t\t\t};\n\n\t\t\t\t// allow . [] and () after tagged template: bar`foo`.length\n\t\t\t\tenv.node = this.gobbleTokenProperty(env.node);\n\n\t\t\t\treturn env.node;\n\t\t\t}\n\t\t});\n\t}\n};\n"],"names":[],"mappings":"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"}