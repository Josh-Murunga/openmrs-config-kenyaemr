System.register(["@openmrs/esm-dynamic-loading","single-spa","@openmrs/esm-config","@openmrs/esm-feature-flags","@openmrs/esm-extensions","@openmrs/esm-utils"],(function(e,n){var t={},o={},r={},i={},a={},s={};return{setters:[function(e){t.importDynamic=e.importDynamic},function(e){o.pathToActiveWhen=e.pathToActiveWhen,o.registerApplication=e.registerApplication},function(e){r.registerModuleWithConfigSystem=e.registerModuleWithConfigSystem},function(e){i.getFeatureFlag=e.getFeatureFlag,i.registerFeatureFlag=e.registerFeatureFlag},function(e){a.attach=e.attach,a.registerExtension=e.registerExtension,a.registerModal=e.registerModal,a.registerWorkspace=e.registerWorkspace},function(e){s.canAccessStorage=e.canAccessStorage}],execute:function(){e((()=>{"use strict";var e={824:e=>{e.exports=r},758:e=>{e.exports=t},45:e=>{e.exports=a},708:e=>{e.exports=i},618:e=>{e.exports=s},645:e=>{e.exports=o}},n={};function c(t){var o=n[t];if(void 0!==o)return o.exports;var r=n[t]={exports:{}};return e[t](r,r.exports,c),r.exports}c.d=(e,n)=>{for(var t in n)c.o(n,t)&&!c.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},c.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),c.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var l={};return(()=>{c.r(l),c.d(l,{addRoutesOverride:()=>S,finishRegisteringAllApps:()=>O,initializeApp:()=>u,isOpenmrsAppRoutes:()=>E,isOpenmrsRoutes:()=>N,localStorageRoutesPrefix:()=>e,registerApp:()=>w,removeRoutesOverride:()=>T,resetAllRoutesOverrides:()=>P,tryRegisterExtension:()=>g});var e="openmrs-routes:",n=c(758),t={bootstrap:function(){return Promise.resolve()},mount:function(){return Promise.resolve()},unmount:function(){return Promise.resolve()}};function o(e,n,t,o,r,i,a){try{var s=e[i](a),c=s.value}catch(e){return void t(e)}s.done?n(c):Promise.resolve(c).then(o,r)}function r(e){return function(){var n=this,t=arguments;return new Promise((function(r,i){var a=e.apply(n,t);function s(e){o(a,r,i,s,c,"next",e)}function c(e){o(a,r,i,s,c,"throw",e)}s(void 0)}))}}function i(e,n){var t,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;a;)try{if(t=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((r=(r=a.trys).length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=n.call(e,a)}catch(e){i=[6,e],o=0}finally{t=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}var a=new Map;function s(e,o){return r((function(){var r;return i(this,(function(i){switch(i.label){case 0:return[4,(0,n.importDynamic)(e)];case 1:return(r=i.sent())&&Object.hasOwn(r,o)&&"function"==typeof r[o]?[2,u(e,r).then((function(){return r[o]()}))]:(r&&Object.hasOwn(r,o)?console.warn("The export ".concat(o," of the app ").concat(e," is not a function")):console.warn("The app ".concat(e," does not define a component called ").concat(o,", this cannot be loaded")),[2,t])}}))}))}function u(e,n){return f.apply(this,arguments)}function f(){return(f=r((function(e,t){var o,r;return i(this,(function(i){switch(i.label){case 0:return e in a?[3,5]:null==t?[3,1]:(r=t,[3,3]);case 1:return[4,(0,n.importDynamic)(e)];case 2:r=i.sent(),i.label=3;case 3:return o=r,[4,a[e]=new Promise((function(e,n){if(Object.hasOwn(o,"startupApp")){var t=o.startupApp;if("function"==typeof t)return Promise.resolve(t()).then(e).catch(n)}e(null)}))];case 4:return i.sent(),[3,7];case 5:return[4,a[e]];case 6:i.sent(),i.label=7;case 7:return[2]}}))}))).apply(this,arguments)}var p=c(645),d=c(824),h=c(708),m=c(45);function g(e,n){var t=n.name;if(t){n.slots&&n.slot&&console.warn("The extension ".concat(t," from ").concat(e," declares both a 'slots' property and\na 'slot' property. Only the 'slots' property will be honored."));var o=n.slots?n.slots:n.slot?[n.slot]:[];if(n.component||n.load){var r,i,a=void 0;if(n.component)a=s(e,n.component);else if(n.load){if("function"!=typeof n.load)return void console.error("The extension ".concat(t," from ").concat(e," declares a 'load' property that is not a function. This is not\nsupported, so the extension will not be loaded."));a=n.load}a&&(0,m.registerExtension)({name:t,load:a,meta:n.meta||{},order:n.order,moduleName:e,privileges:n.privileges,online:null===(r=n.online)||void 0===r||r,offline:null!==(i=n.offline)&&void 0!==i&&i,featureFlag:n.featureFlag});var c=!0,l=!1,u=void 0;try{for(var f,p=o[Symbol.iterator]();!(c=(f=p.next()).done);c=!0){var d=f.value;(0,m.attach)(d,t)}}catch(e){l=!0,u=e}finally{try{c||null==p.return||p.return()}finally{if(l)throw u}}}else console.error("The extension ".concat(t," from ").concat(e," is missing a 'component' entry and thus cannot be registered.\nTo fix this, ensure that you define a 'component' field inside the extension definition."),n)}else console.error("An extension definition in ".concat(e,' is missing an name and thus cannot be\nregistered. To fix this, ensure that you define the "name" field inside the\nextension definition.'),n)}function y(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var v=[];function b(e){if(Array.isArray(e)){var n=e.map(b);return function(e){return n.some((function(n){return n(e)}))}}return"string"==typeof e?(0,p.pathToActiveWhen)(window.getOpenmrsSpaBase()+e):(t=e,(null!=(o=RegExp)&&"undefined"!=typeof Symbol&&o[Symbol.hasInstance]?o[Symbol.hasInstance](t):t instanceof o)?function(n){return function(e,n){return e.test(n.pathname.replace(window.getOpenmrsSpaBase(),""))}(e,n)}:function(){return e});var t,o}function w(e,n){if(e&&n&&"object"==typeof n){var t,o;(0,d.registerModuleWithConfigSystem)(e);var r,i,a,c=null!==(o=n.extensions)&&void 0!==o?o:[],l=null!==(r=n.modals)&&void 0!==r?r:[],u=null!==(i=n.workspaces)&&void 0!==i?i:[],f=null!==(a=n.featureFlags)&&void 0!==a?a:[];null===(t=n.pages)||void 0===t||t.forEach((function(n){var t,o,r;n&&"object"==typeof n&&Object.hasOwn(n,"component")&&(Object.hasOwn(n,"route")||Object.hasOwn(n,"routeRegex")||Object.hasOwn(n,"routes"))?v.push((o=function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},o=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),o.forEach((function(n){y(e,n,t[n])}))}return e}({},n),r=null!=(r={order:null!==(t=n.order)&&void 0!==t?t:Number.MAX_SAFE_INTEGER,appName:e})?r:{},Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):function(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t.push.apply(t,o)}return t}(Object(r)).forEach((function(e){Object.defineProperty(o,e,Object.getOwnPropertyDescriptor(r,e))})),o)):console.warn("A page for ".concat(e," could not be registered as it does not appear to have the required properties"),n)})),c.forEach((function(n){n&&"object"==typeof n&&Object.hasOwn(n,"name")&&Object.hasOwn(n,"component")?g(e,n):console.warn("An extension for ".concat(e," could not be registered as it does not appear to have the required properties"),n)})),l.forEach((function(n){n&&"object"==typeof n&&Object.hasOwn(n,"name")&&Object.hasOwn(n,"component")?function(e,n){var t=n.name;if(t)if(n.component||n.load){var o=void 0;if(n.component)o=s(e,n.component);else if(n.load){if("function"!=typeof n.load)return void console.error("The modal ".concat(t," from ").concat(e," declares a 'load' property that is not a function. This is not\nsupported, so the modal will not be loaded."));o=n.load}o&&(0,m.registerModal)({name:t,load:o,moduleName:e})}else console.error("The modal ".concat(t," from ").concat(e," is missing a 'component' entry and thus cannot be registered.\nTo fix this, ensure that you define a 'component' field inside the modal definition."),n);else console.error("A modal definition in ".concat(e,' is missing an name and thus cannot be\nregistered. To fix this, ensure that you define the "name" field inside the\nmodal definition.'),n)}(e,n):console.warn("A modal for ".concat(e," could not be registered as it does not appear to have the required properties"),n)})),u.forEach((function(n){n&&"object"==typeof n&&Object.hasOwn(n,"name")&&Object.hasOwn(n,"component")?function(e,n){var t=n.name;if(t){var o=n.title;if(o)if(n.component||n.load){var r=void 0;if(n.component)r=s(e,n.component);else if(n.load){if("function"!=typeof n.load)return void console.error("The workspace ".concat(t," from ").concat(e," declares a 'load' property that is not a function. This is not\nsupported, so the workspace will not be loaded."));r=n.load}r&&(0,m.registerWorkspace)({name:t,title:o,load:r,moduleName:e,type:n.type,canHide:n.canHide,canMaximize:n.canMaximize,width:n.width,cancelTitle:n.cancelTitle,cancelMessage:n.cancelMessage,cancelConfirmText:n.cancelConfirmText,hasOwnSidebar:n.hasOwnSidebar,sidebarFamily:n.sidebarFamily,preferredWindowSize:n.preferredWindowSize})}else console.error("The workspace ".concat(t," from ").concat(e," is missing a 'component' entry and thus cannot be registered.\nTo fix this, ensure that you define a 'component' field inside the workspace definition."),n);else console.error("A workspace definition in ".concat(e,' is missing a title and thus cannot be registered.\nTo fix this, ensure that you define the "title" field inside the workspace definition.'),n)}else console.error("A workspace definition in ".concat(e,' is missing a name and thus cannot be registered.\nTo fix this, ensure that you define the "name" field inside the workspace definition.'),n)}(e,n):console.warn("A workspace for ".concat(e," could not be registered as it does not appear to have the required properties"),n)})),f.forEach((function(n){n&&"object"==typeof n&&Object.hasOwn(n,"flagName")?function(e,n){n.flagName?n.label?n.description?(0,h.registerFeatureFlag)(n.flagName,n.label,n.description):console.error("A feature flag definition in ".concat(e,' is missing a description and thus cannot be registered.\nTo fix this, ensure that you define the "description" field inside the feature flag definition.'),n):console.error("A feature flag definition in ".concat(e,' is missing a description and thus cannot be registered.\nTo fix this, ensure that you define the "label" field inside the feature flag definition.'),n):console.error("A feature flag definition in ".concat(e,' is missing a name and thus cannot be registered.\nTo fix this, ensure that you define the "name" field inside the feature flag definition.'),n)}(e,n):console.warn("A feature flag for ".concat(e," could not be registered as it does not appear to have the required properties"),n)}))}}function O(){v.sort((function(e,n){var t=e.order-n.order;return 0!=t?t:e.appName.localeCompare(n.appName,"en")}));var e=new Map,n=!0,t=!1,o=void 0;try{for(var r,i=v[Symbol.iterator]();!(n=(r=i.next()).done);n=!0){var a=r.value;e.has(a.appName)?e.set(a.appName,e.get(a.appName)+1):e.set(a.appName,0);var s=e.get(a.appName),c="".concat(a.appName,"-page-").concat(s),l=document.createElement("div");l.id="single-spa-application:".concat(c),document.body.appendChild(l),x(c,a)}}catch(e){t=!0,o=e}finally{try{n||null==i.return||i.return()}finally{if(t)throw o}}}function x(e,n){var t=void 0!==n.route?n.route:void 0!==n.routeRegex&&new RegExp(n.routeRegex);if(!1!==t)if(n.component){var o=function(e,n){var t=n.online,o=n.offline,r=n.featureFlag;return window.offlineEnabled?function(n){return!!(navigator.onLine&&(null==t||t)||!navigator.onLine&&null!=o&&o)&&!(r&&!(0,h.getFeatureFlag)(r))&&e(n)}:e}(b(t),n),r=s(n.appName,n.component);(0,p.registerApplication)(e,r,o)}else console.warn('A registered page definition is missing a component and thus cannot be registered.\nTo fix this, ensure that you define the "component" field inside the page definition.',e);else console.warn('A registered page definition is missing a route and thus cannot be registered.\nTo fix this, ensure that you define the "route" (or alternatively the "routeRegex") field inside the extension definition.',e)}function A(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,o=new Array(n);t<n;t++)o[t]=e[t];return o}var j=(0,c(618).canAccessStorage)();function S(e,n){if(j){if("string"==typeof n){if(n.startsWith("http"))return k(e,n);try{var t=JSON.parse(n);if(E(t))return k(e,t);console.error("The supplied routes for ".concat(e," is not a valid OpenmrsAppRoutes object"),n)}catch(n){console.error("Could not add routes override for ".concat(e,": "),n)}}else{if(o=n,null!=(r=URL)&&"undefined"!=typeof Symbol&&r[Symbol.hasInstance]?r[Symbol.hasInstance](o):o instanceof r)return k(e,n.toString());if(E(n))return k(e,n)}var o,r;console.error("Override for ".concat(e," is not in a valid format. Expected either a Javascript Object, a JSON string of a Javascript object, or a URL"),n)}}function T(n){if(j){var t=e+n;localStorage.removeItem(t)}}function P(){if(j)for(var n=window.localStorage,t=0;t<n.length;t++){var o=n.key(t);(null==o?void 0:o.startsWith(e))&&n.removeItem(o)}}function k(n,t){var o=e+n;localStorage.setItem(o,JSON.stringify(t))}function E(e){if(e&&"object"==typeof e){var n=Object.prototype.hasOwnProperty,t=e;return!!((!n.call(e,"pages")||Boolean(t.pages)&&Array.isArray(t.pages))&&(!n.call(e,"extensions")||Boolean(t.extensions)&&Array.isArray(t.extensions))&&(!n.call(e,"workspaces")||Boolean(t.workspaces)&&Array.isArray(t.workspaces))&&(!n.call(e,"modals")||Boolean(t.modals)&&Array.isArray(t.modals)))}return!1}function N(e){if(e&&"object"==typeof e){var n=e;return Object.entries(n).every((function(e){var n,t,o=(t=2,function(e){if(Array.isArray(e))return e}(n=e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var o,r,i=[],a=!0,s=!1;try{for(t=t.call(e);!(a=(o=t.next()).done)&&(i.push(o.value),!n||i.length!==n);a=!0);}catch(e){s=!0,r=e}finally{try{a||null==t.return||t.return()}finally{if(s)throw r}}return i}}(n,t)||function(e,n){if(e){if("string"==typeof e)return A(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(t):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?A(e,n):void 0}}(n,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),r=o[0],i=o[1];return"string"==typeof r&&E(i)}))}return!1}})(),l})())}}}));
//# sourceMappingURL=openmrs-esm-utils.js.map